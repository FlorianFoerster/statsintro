

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Correlation &mdash; Introduction to Statistics 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Introduction to Statistics 1.0 documentation" href="index.html" />
    <link rel="next" title="Variance Analysis" href="statsANOVA.html" />
    <link rel="prev" title="One Proportion" href="statsCategorical.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="statsANOVA.html" title="Variance Analysis"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="statsCategorical.html" title="One Proportion"
             accesskey="P">previous</a> |</li>
        <li><a href="StatsFH.html">Introduction to Statistics 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <img alt="_images/title_relations.png" src="_images/title_relations.png" style="height: 100px;" />
<p>If we have two related variables, the <em>correlation</em> measures the
association between the two variables. In contrast, a <em>linear
regression</em> is used for the prediction of the value of one variable from
another. If we want to compare more than two groups of variables, we
have to use a technique known as <em>Analysis of Variance (ANOVA)</em>.</p>
<div class="section" id="correlation">
<h1>Correlation<a class="headerlink" href="#correlation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="correlation-coefficient">
<h2>Correlation Coefficient<a class="headerlink" href="#correlation-coefficient" title="Permalink to this headline">¶</a></h2>
<p>If the two variables are normally distributed, the standard measure of
determining the <em>correlation coefficient</em>, often ascribed to <em>Pearson</em> ,
is</p>
<div class="math">
\[\label{eq:pearson}
  r = \frac{\sum\limits_{i=1}^n (X_i - \bar{X})(Y_i - \bar{Y})}{\sqrt{\sum\limits_{i=1}^n (X_i - \bar{X})^2} \sqrt{\sum\limits_{i=1}^n (Y_i - \bar{Y})^2}}\]</div>
<p>Pearson’s correlation coefficient, sometimes also referred to as
<em>population correlation coefficient</em>, can take any value from -1 to +1.
Examples are given in the figure below. Note that the formula
for the correlation coefficient is symmetrical between <span class="math">\(x\)</span> and
<span class="math">\(y\)</span>.</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="_images/Correlation_examples2.png"><img alt="image26" src="_images/Correlation_examples2.png" style="width: 500.0px; height: 228.5px;" /></a></div>
</div>
</div>
<div class="section" id="rank-correlation">
<h2>Rank correlation<a class="headerlink" href="#rank-correlation" title="Permalink to this headline">¶</a></h2>
<p>If the data distribution is not normal, a different approach is
necessary. In that case one can rank the set of subjects for each
variable and compare the orderings. There are two commonly used methods
of calculating the rank correlation.</p>
<ul class="simple">
<li><em>Spearman&#8217;s :math:`rho`</em>, which is exactly the same as the Pearson
correlation coefficient <span class="math">\(r\)</span> calculated on the ranks of the
observations.</li>
<li><em>Kendall&#8217;s :math:`tau`</em>.</li>
</ul>
</div>
</div>
<div class="section" id="regression">
<h1>Regression<a class="headerlink" href="#regression" title="Permalink to this headline">¶</a></h1>
<p>We can use the method of <em>regression</em> when we want to predict the value
of one variable from the other.</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="_images/Linear_regression.png"><img alt="image27" src="_images/Linear_regression.png" style="width: 500.0px; height: 330.0px;" /></a></div>
</div>
<p>When we search for the best-fit line to a given <span class="math">\((x_i,y_i)\)</span>
dataset, we are looking for the parameters <span class="math">\((k,d)\)</span> which minimize
the sum of the squared <em>residuals</em> <span class="math">\(\epsilon_i\)</span> in</p>
<div class="math">
\[\label{eq:simpleRegression}
  y_i = k * x_i + d + \epsilon_i\]</div>
<p>where <span class="math">\(k\)</span> is the <em>slope</em> or <em>inclination</em> of the line, and
<span class="math">\(d\)</span> the <em>intercept</em>. This is in fact just the one-dimensional
example of the more general technique, which is described in the next
section. Note that in contrast to the correlation, this relationship
between <span class="math">\(x\)</span> and <span class="math">\(y\)</span> is no more symmetrical: it is assumed
that the <span class="math">\(x-\)</span>values are known exactly, and that all the
variability lies in the residuals.</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="_images/residuals_linreg.png"><img alt="image28" src="_images/residuals_linreg.png" style="width: 600.0px; height: 400.0px;" /></a></div>
</div>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><a class="footnote-reference" href="#id2" id="id1">[4]</a> Given a data set <span class="math">\(\{y_i,\, x_{i1}, \ldots, x_{ip}\}_{i=1}^n\)</span></div></blockquote>
<p>of <span class="math">\(n\)</span> statistical units, a linear regression model assumes that
the relationship between the dependent variable <span class="math">\(y_i\)</span> and the
<span class="math">\(p\)</span>-vector of regressors <span class="math">\(x_i\)</span> is linear. This relationship
is modelled through a <em>disturbance term</em> or <em>error variable</em>
<span class="math">\(\epsilon_i\)</span>, an unobserved random variable that adds noise to the
linear relationship between the dependent variable and regressors. Thus
the model takes the form</p>
<div class="math">
\[\label{eq:regression}
   y_i = \beta_1   x_{i1} + \cdots + \beta_p x_{ip} + \varepsilon_i
   = \mathbf{x}^{\rm T}_i\boldsymbol\beta + \varepsilon_i,
   \qquad i = 1, \ldots, n,\]</div>
<p>where <span class="math">\(^T\)</span> denotes the transpose, so that <span class="math">\(x_i^T\beta\)</span> is
the inner product between vectors <span class="math">\(x_i\)</span> <span class="math">\(\beta\)</span>.</p>
<p>Often these <span class="math">\(n\)</span> equations are stacked together and written in
vector form as</p>
<div class="math">
\[\mathbf{y} = \mathbf{X}\boldsymbol\beta + \boldsymbol\varepsilon, \,\]</div>
<p>where</p>
<div class="math">
\[\begin{split}\mathbf{y} = \begin{pmatrix} y_1 \\ y_2 \\ \vdots \\ y_n \end{pmatrix}, \quad
   \mathbf{X} = \begin{pmatrix} \mathbf{x}^{\rm T}_1 \\ \mathbf{x}^{\rm T}_2 \\ \vdots \\ \mathbf{x}^{\rm T}_n \end{pmatrix}
   = \begin{pmatrix} x_{11} &amp; \cdots &amp; x_{1p} \\
   x_{21} &amp; \cdots &amp; x_{2p} \\
   \vdots &amp; \ddots &amp; \vdots \\
   x_{n1} &amp; \cdots &amp; x_{np}
   \end{pmatrix}, \quad
   \boldsymbol\beta = \begin{pmatrix} \beta_1 \\ \vdots \\ \beta_p \end{pmatrix}, \quad
   \boldsymbol\varepsilon = \begin{pmatrix} \varepsilon_1 \\ \varepsilon_2 \\ \vdots \\ \varepsilon_n \end{pmatrix}.\end{split}\]</div>
<p>Some remarks on terminology and general use:</p>
<ul class="simple">
<li><span class="math">\(y_i\)</span> is called the <em>regressand</em>, <em>endogenous variable</em>,
<em>response variable</em>, <em>measured variable</em>, or <em>dependent variable</em>.
The decision as to which variable in a data set is modeled as the
dependent variable and which are modeled as the independent variables
may be based on a presumption that the value of one of the variables
is caused by, or directly influenced by the other variables.
Alternatively, there may be an operational reason to model one of the
variables in terms of the others, in which case there need be no
presumption of causality.</li>
<li><span class="math">\(\mathbf{x}_i\)</span> are called <em>regressors</em>, <em>exogenous variables</em>,
<em>explanatory variables</em>, <em>covariates</em>, <em>input variables</em>, <em>predictor
variables</em>, or <em>independent variables</em>, but not to be confused with
<em>independent random variables</em>. The matrix <span class="math">\(\mathbf{X}\)</span> is
sometimes called the <em>design matrix</em>.<ul>
<li>Usually a constant is included as one of the regressors. For
example we can take <span class="math">\(x_{i1}=1\)</span> for <span class="math">\(i=1,...,n\)</span>. The
corresponding element of <span class="math">\(\beta\)</span> is called the <em>intercept</em>.
Many statistical inference procedures for linear models require an
intercept to be present, so it is often included even if
theoretical considerations suggest that its value should be zero.</li>
<li>Sometimes one of the regressors can be a non-linear function of
another regressor or of the data, as in polynomial regression and
segmented regression. The model remains linear as long as it is
linear in the parameter vector <span class="math">\(\beta\)</span>.</li>
<li>The regressors <span class="math">\(x_{ij}\)</span> may be viewed either as random
variables, which we simply observe, or they can be considered as
predetermined fixed values which we can choose. Both
interpretations may be appropriate in different cases, and they
generally lead to the same estimation procedures; however
different approaches to asymptotic analysis are used in these two
situations.</li>
</ul>
</li>
<li><span class="math">\(\boldsymbol\beta\,\)</span> is a <span class="math">\(p\)</span>-dimensional <em>parameter
vector</em>. Its elements are also called <em>effects</em>, or <em>regression
coefficients</em>. Statistical estimation and inference in linear
regression focuses on <span class="math">\(\beta\)</span>.</li>
<li><span class="math">\(\varepsilon_i\,\)</span> is called the <em>error term</em>, <em>disturbance
term</em>, or <em>noise</em>. This variable captures all other factors which
influence the dependent variable <span class="math">\(y_i\)</span> other than the
regressors <span class="math">\(x_i\)</span>. The relationship between the error term and
the regressors, for example whether they are correlated, is a crucial
step in formulating a linear regression model, as it will determine
the method to use for estimation.</li>
<li>If <span class="math">\(i=1\)</span> and <span class="math">\(p=1\)</span> in Eq.[eq:regression], we have a
<em>simple linear regression</em>, corresponding to
Eq.[eq:simpleRegression]. If <span class="math">\(i&gt;1\)</span> we talk about <em>multilinear
regression</em> or <em>multiple linear regression</em> .</li>
</ul>
<p><em>Example</em>. Consider a situation where a small ball is being tossed up in
the air and then we measure its heights of ascent <span class="math">\(h_i\)</span> at various
moments in time <span class="math">\(t_i\)</span>. Physics tells us that, ignoring the drag,
the relationship can be modelled as :</p>
<div class="math">
\[h_i = \beta_1 t_i + \beta_2 t_i^2 + \varepsilon_i,\]</div>
<p>where <span class="math">\(\beta_1\)</span> determines the initial velocity of the ball,
<span class="math">\(\beta_2\)</span> is proportional to the standard gravity, and
<span class="math">\(\epsilon_i\)</span> is due to measurement errors. Linear regression can
be used to estimate the values of <span class="math">\(\beta_1\)</span> and <span class="math">\(\beta_2\)</span>
from the measured data. This model is non-linear in the time variable,
but it is linear in the parameters <span class="math">\(\beta_1\)</span> and <span class="math">\(\beta_2\)</span>;
if we take regressors
<span class="math">\(\mathbf{x}_i = (x_{i1},x_{i2}) = (t_i,t_i^2)\)</span>, the model takes on
the standard form :
<span class="math">\(h_i = \mathbf{x}^{\rm T}_i\boldsymbol\beta + \varepsilon_i.\)</span></p>
</div>
<div class="section" id="assumptions">
<h2>Assumptions<a class="headerlink" href="#assumptions" title="Permalink to this headline">¶</a></h2>
<p>To use the technique of linear regression, five assumptions should be
fulfilled:</p>
<ul class="simple">
<li>The errors in the data values (i.e. the deviations from average) are
independent from one another.</li>
<li>The model must be appropriate. (A linear regression does not properly
describe a quadratic curve.)</li>
<li>The <em>independent variables</em> (i.e. <span class="math">\(x\)</span>) are exactly known.</li>
<li>The variance of the <em>dependent variable</em> (i.e. <span class="math">\(y\)</span>) is the same
for all values of <span class="math">\(x\)</span>.</li>
<li>The distribution of <span class="math">\(y\)</span> is approximately normal for all values
of <span class="math">\(x\)</span>.</li>
</ul>
<p>(See also the ipython notebook <a class="reference external" href="http://nbviewer.ipython.org/url/work.thaslwanter.at/Stats/ipynb/multivariate.ipynb">multivariate.ipynb</a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="sd">&#39;&#39;&#39; Analysis of multivariate data</span>
<span class="sd">- Analysis of paired data</span>
<span class="sd">- Analysis of unpaired data</span>
<span class="sd">- Regression line</span>
<span class="sd">- Correlation</span>

<span class="sd">&#39;&#39;&#39;</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Author:  Thomas Haslwanter</span>
<span class="sd">Date:    Jan-2013</span>
<span class="sd">Version: 1.3</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">genfromtxt</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="kn">as</span> <span class="nn">stats</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">getdata</span> <span class="kn">import</span> <span class="n">getData</span>

<span class="k">def</span> <span class="nf">paired_data</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;Analysis of paired data</span>
<span class="sd">    Compare mean daily intake over 10 pre-menstrual and 10 post-menstrual days (in kJ).&#39;&#39;&#39;</span>
    
    <span class="c"># Get the data:  daily intake of energy in kJ for 11 women</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">getData</span><span class="p">(</span><span class="s">&#39;altman_93.txt&#39;</span><span class="p">)</span>
    
    <span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">std</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">pre</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">post</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="c"># paired t-test: doing two measurments on the same experimental unit</span>
    <span class="c"># e.g., before and after a treatment</span>
    <span class="n">t_statistic</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">ttest_1samp</span><span class="p">(</span><span class="n">post</span> <span class="o">-</span> <span class="n">pre</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    
    <span class="c"># p &lt; 0.05 =&gt; alternative hypothesis:</span>
    <span class="c"># the difference in mean is not equal to 0</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;paired t-test&quot;</span><span class="p">,</span> <span class="n">p_value</span><span class="p">)</span>
    
    <span class="c"># alternative to paired t-test when data has an ordinary scale or when not</span>
    <span class="c"># normally distributed</span>
    <span class="n">z_statistic</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">wilcoxon</span><span class="p">(</span><span class="n">post</span> <span class="o">-</span> <span class="n">pre</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;paired wilcoxon-test&quot;</span><span class="p">,</span> <span class="n">p_value</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">unpaired_data</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39; Then some unpaired comparison: 24 hour total energy expenditure (MJ/day),</span>
<span class="sd">    in groups of lean and obese women&#39;&#39;&#39;</span>
    
    <span class="c"># Get the data: energy expenditure in mJ and stature (0=obese, 1=lean)</span>
    <span class="n">energ</span> <span class="o">=</span> <span class="n">getData</span><span class="p">(</span><span class="s">&#39;altman_94.txt&#39;</span><span class="p">)</span>
    
    <span class="c"># Group them</span>
    <span class="n">group1</span> <span class="o">=</span> <span class="n">energ</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span>
    <span class="n">group1</span> <span class="o">=</span> <span class="n">energ</span><span class="p">[</span><span class="n">group1</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">group2</span> <span class="o">=</span> <span class="n">energ</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
    <span class="n">group2</span> <span class="o">=</span> <span class="n">energ</span><span class="p">[</span><span class="n">group2</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">]</span>
    
    <span class="n">mean</span><span class="p">(</span><span class="n">group1</span><span class="p">)</span>
    <span class="n">mean</span><span class="p">(</span><span class="n">group2</span><span class="p">)</span>
    
    <span class="c"># two-sample t-test</span>
    <span class="c"># null hypothesis: the two groups have the same mean</span>
    <span class="c"># this test assumes the two groups have the same variance...</span>
    <span class="c"># (can be checked with tests for equal variance)</span>
    <span class="c"># independent groups: e.g., how boys and girls fare at an exam</span>
    <span class="c"># dependent groups: e.g., how the same class fare at 2 different exams</span>
    <span class="n">t_statistic</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">group1</span><span class="p">,</span> <span class="n">group2</span><span class="p">)</span>
    
    <span class="c"># p_value &lt; 0.05 =&gt; alternative hypothesis:</span>
    <span class="c"># they don&#39;t have the same mean at the 5% significance level</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;two-sample t-test&quot;</span><span class="p">,</span> <span class="n">p_value</span><span class="p">)</span>
    
    <span class="c"># For non-normally distributed data, perform the two-sample wilcoxon test</span>
    <span class="c"># a.k.a Mann Whitney U</span>
    <span class="n">u</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">mannwhitneyu</span><span class="p">(</span><span class="n">group1</span><span class="p">,</span> <span class="n">group2</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;two-sample wilcoxon-test&quot;</span><span class="p">,</span> <span class="n">p_value</span><span class="p">)</span>
    
    <span class="c"># Plot the data</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">group1</span><span class="p">,</span> <span class="s">&#39;bx&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;obese&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hold</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">group2</span><span class="p">,</span> <span class="s">&#39;ro&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;lean&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">regression_line</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;Fit a line, using the powerful &quot;ordinary least square&quot; method of pandas&#39;&#39;&#39;</span>
    
    <span class="c"># Get the data</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">getData</span><span class="p">(</span><span class="s">&#39;altman_11_6.txt&#39;</span><span class="p">)</span>
    
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;glucose&#39;</span><span class="p">,</span> <span class="s">&#39;Vcf&#39;</span><span class="p">])</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s">&#39;Vcf&#39;</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s">&#39;glucose&#39;</span><span class="p">])</span>
    <span class="k">print</span> <span class="n">model</span><span class="o">.</span><span class="n">summary</span>    
    
<span class="k">def</span> <span class="nf">correlation</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;Pearson correlation, and two types of rank correlation (Spearman, Kendall)</span>
<span class="sd">    Data from 24 type 1 diabetic patients, relating Fasting blood glucose (mmol/l) to</span>
<span class="sd">    mean circumferential shortening velocity (%/sec).&#39;&#39;&#39;</span>
    
    <span class="c"># Get the data</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">getData</span><span class="p">(</span><span class="s">&#39;altman_11_1.txt&#39;</span><span class="p">)</span>
    
    <span class="c"># Bring them into the dataframe-format</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;age&#39;</span><span class="p">,</span> <span class="s">&#39;fat&#39;</span><span class="p">])</span>
    
    <span class="c"># Calculate correlations</span>
    <span class="n">corr</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">corr</span><span class="p">[</span><span class="s">&#39;pearson&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">&#39;age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">&#39;fat&#39;</span><span class="p">],</span> <span class="n">method</span> <span class="o">=</span> <span class="s">&#39;pearson&#39;</span><span class="p">)</span>
    <span class="n">corr</span><span class="p">[</span><span class="s">&#39;spearman&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">&#39;age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">&#39;fat&#39;</span><span class="p">],</span> <span class="n">method</span> <span class="o">=</span> <span class="s">&#39;spearman&#39;</span><span class="p">)</span>
    <span class="n">corr</span><span class="p">[</span><span class="s">&#39;kendall&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">&#39;age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">&#39;fat&#39;</span><span class="p">],</span> <span class="n">method</span> <span class="o">=</span> <span class="s">&#39;kendall&#39;</span><span class="p">)</span>
    
    <span class="k">print</span><span class="p">(</span><span class="n">corr</span><span class="p">)</span>    
    
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">paired_data</span><span class="p">()</span>    
    <span class="n">unpaired_data</span><span class="p">()</span>
    <span class="n">regression_line</span><span class="p">()</span>    
    <span class="n">correlation</span><span class="p">()</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="_images/Anscombes_quartet.png"><img alt="image29" src="_images/Anscombes_quartet.png" style="width: 500.0px; height: 363.5px;" /></a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="_images/regression_wLegend.png"><img alt="image30" src="_images/regression_wLegend.png" style="width: 407.5px; height: 307.5px;" /></a></div>
</div>
<p>Since to my knowledge there exists no program in the Python standard
library (or numpy, scipy) to calculate the confidence intervals for a
regression line, I include my corresponding program <em>lineFit.py</em>.
The output of this program is shown in the figure below.
This program also shows how Python programs intended for
distribution should be documented.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Linear regression fit</span>

<span class="sd">Parameters</span>
<span class="sd">----------</span>
<span class="sd">x : ndarray</span>
<span class="sd">    Input / Predictor    </span>
<span class="sd">y : ndarray</span>
<span class="sd">    Input / Estimator    </span>
<span class="sd">alpha : float</span>
<span class="sd">    Confidence limit [default=0.05]</span>
<span class="sd">newx : float or ndarray</span>
<span class="sd">    Values for which the fit and the prediction limits are calculated (optional)</span>
<span class="sd">plotFlag: int (optional)</span>
<span class="sd">    1 = plot, 0 = no_plot [default]</span>
<span class="sd">    </span>
<span class="sd">Returns</span>
<span class="sd">-------</span>
<span class="sd">a : float</span>
<span class="sd">    Intercept</span>
<span class="sd">b : float</span>
<span class="sd">    Slope</span>
<span class="sd">ci : ndarray</span>
<span class="sd">    Lower and upper confidence interval for the slope</span>
<span class="sd">info : dictionary, containing return information on</span>
<span class="sd">    - residuals</span>
<span class="sd">    - var_res</span>
<span class="sd">    - sd_res</span>
<span class="sd">    - alpha</span>
<span class="sd">    - tval</span>
<span class="sd">    - df</span>
<span class="sd">newy : list(ndarray)</span>
<span class="sd">    Predictions for (newx, newx-ciPrediction, newx+ciPrediction)</span>

<span class="sd">Examples</span>
<span class="sd">--------</span>
<span class="sd">&gt;&gt;&gt; import numpy as np</span>
<span class="sd">&gt;&gt;&gt; from fitLine import fitLine</span>
<span class="sd">&gt;&gt;&gt; x = np.r_[0:10:11j]</span>
<span class="sd">&gt;&gt;&gt; y = x**2</span>
<span class="sd">&gt;&gt;&gt; (a,b,(ci_a, ci_b),_)=fitLine(x,y)    </span>

<span class="sd">Notes</span>
<span class="sd">-----</span>
<span class="sd">Example data and formulas are taken from</span>
<span class="sd">D. Altman, &quot;Practical Statistics for Medicine&quot;</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">author : thomas haslwanter</span>
<span class="sd">date : 13.Dec.2012</span>
<span class="sd">ver : 1.2</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="kn">as</span> <span class="nn">stats</span>

<span class="k">def</span> <span class="nf">fitLine</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">newx</span><span class="o">=</span><span class="p">[],</span> <span class="n">plotFlag</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Fit a curve to the data using a least squares 1st order polynomial fit &#39;&#39;&#39;</span>
    
    <span class="c"># Summary data</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>			   <span class="c"># number of samples     </span>
    
    <span class="n">Sxx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">n</span>
<span class="c">#    Syy = np.sum(y**2) - np.sum(y)**2/n    # not needed here</span>
    <span class="n">Sxy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>    
    <span class="n">mean_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">mean_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    
    <span class="c"># Linefit</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">Sxy</span><span class="o">/</span><span class="n">Sxx</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">mean_y</span> <span class="o">-</span> <span class="n">b</span><span class="o">*</span><span class="n">mean_x</span>
    
    <span class="c"># Residuals</span>
    <span class="n">fit</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xx</span><span class="p">:</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">xx</span>    
    <span class="n">residuals</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="n">var_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">residuals</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">sd_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">var_res</span><span class="p">)</span>
    
    <span class="c"># Confidence intervals</span>
    <span class="n">se_b</span> <span class="o">=</span> <span class="n">sd_res</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Sxx</span><span class="p">)</span>
    <span class="n">se_a</span> <span class="o">=</span> <span class="n">sd_res</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">Sxx</span><span class="p">))</span>
    
    <span class="n">df</span> <span class="o">=</span> <span class="n">n</span><span class="o">-</span><span class="mi">2</span>                            <span class="c"># degrees of freedom</span>
    <span class="n">tval</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">isf</span><span class="p">(</span><span class="n">alpha</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span> 	<span class="c"># appropriate t value</span>
    
    <span class="n">ci_a</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">tval</span><span class="o">*</span><span class="n">se_a</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">ci_b</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="n">tval</span><span class="o">*</span><span class="n">se_b</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

    <span class="c"># create series of new test x-values to predict for</span>
    <span class="n">npts</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="n">px</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">num</span><span class="o">=</span><span class="n">npts</span><span class="p">)</span>
    
    <span class="n">se_fit</span>     <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">sd_res</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>  <span class="mf">1.</span><span class="o">/</span><span class="n">n</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">mean_x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">Sxx</span><span class="p">)</span>
    <span class="n">se_predict</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">sd_res</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mf">1.</span><span class="o">/</span><span class="n">n</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">mean_x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">Sxx</span><span class="p">)</span>
    
    <span class="k">print</span> <span class="s">&#39;Summary: a={0:5.4f}+/-{1:5.4f}, b={2:5.4f}+/-{3:5.4f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">tval</span><span class="o">*</span><span class="n">se_a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">tval</span><span class="o">*</span><span class="n">se_b</span><span class="p">)</span>
    <span class="k">print</span> <span class="s">&#39;Confidence intervals: ci_a=({0:5.4f} - {1:5.4f}), ci_b=({2:5.4f} - {3:5.4f})&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ci_a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ci_a</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ci_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ci_b</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">print</span> <span class="s">&#39;Residuals: variance = {0:5.4f}, standard deviation = {1:5.4f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">var_res</span><span class="p">,</span> <span class="n">sd_res</span><span class="p">)</span>
    <span class="k">print</span> <span class="s">&#39;alpha = {0:.3f}, tval = {1:5.4f}, df={2:d}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">tval</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>
    
    <span class="c"># Return info</span>
    <span class="n">ri</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;residuals&#39;</span><span class="p">:</span> <span class="n">residuals</span><span class="p">,</span> 
        <span class="s">&#39;var_res&#39;</span><span class="p">:</span> <span class="n">var_res</span><span class="p">,</span>
        <span class="s">&#39;sd_res&#39;</span><span class="p">:</span> <span class="n">sd_res</span><span class="p">,</span>
        <span class="s">&#39;alpha&#39;</span><span class="p">:</span> <span class="n">alpha</span><span class="p">,</span>
        <span class="s">&#39;tval&#39;</span><span class="p">:</span> <span class="n">tval</span><span class="p">,</span>
        <span class="s">&#39;df&#39;</span><span class="p">:</span> <span class="n">df</span><span class="p">}</span>
    
    <span class="k">if</span> <span class="n">plotFlag</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c"># Plot the data</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">px</span><span class="p">,</span> <span class="n">fit</span><span class="p">(</span><span class="n">px</span><span class="p">),</span><span class="s">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;Regression line&#39;</span><span class="p">)</span>
        <span class="c">#plt.plot(x,y,&#39;k.&#39;, label=&#39;Sample observations&#39;, ms=10)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s">&#39;k.&#39;</span><span class="p">)</span>
        
        <span class="n">x</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">limit</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">tval</span><span class="o">*</span><span class="n">se_fit</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s">&#39;r--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;Confidence limit ({0:.1f}%)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">limit</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">tval</span><span class="o">*</span><span class="n">se_fit</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s">&#39;r--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span> <span class="p">)</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">tval</span><span class="o">*</span><span class="n">se_predict</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;Prediction limit ({0:.1f}%)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">limit</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">tval</span><span class="o">*</span><span class="n">se_predict</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.2</span><span class="p">))</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;X values&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Y values&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;Linear regression and confidence limits&#39;</span><span class="p">)</span>
        
        <span class="c"># configure legend</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">leg</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span>
        <span class="n">ltext</span> <span class="o">=</span> <span class="n">leg</span><span class="o">.</span><span class="n">get_texts</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ltext</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="c"># show the plot</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        
    <span class="k">if</span> <span class="n">newx</span> <span class="o">!=</span> <span class="p">[]:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">newx</span><span class="o">.</span><span class="n">size</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">newx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">newx</span><span class="p">])</span>
    
        <span class="k">print</span> <span class="s">&#39;Example: x = {0}+/-{1} =&gt; se_fit = {2:5.4f}, se_predict = {3:6.5f}&#39;</span>\
        <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">newx</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tval</span><span class="o">*</span><span class="n">se_predict</span><span class="p">(</span><span class="n">newx</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">se_fit</span><span class="p">(</span><span class="n">newx</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">se_predict</span><span class="p">(</span><span class="n">newx</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        
        <span class="n">newy</span> <span class="o">=</span> <span class="p">(</span><span class="n">fit</span><span class="p">(</span><span class="n">newx</span><span class="p">),</span> <span class="n">fit</span><span class="p">(</span><span class="n">newx</span><span class="p">)</span><span class="o">-</span><span class="n">se_predict</span><span class="p">(</span><span class="n">newx</span><span class="p">),</span> <span class="n">fit</span><span class="p">(</span><span class="n">newx</span><span class="p">)</span><span class="o">+</span><span class="n">se_predict</span><span class="p">(</span><span class="n">newx</span><span class="p">))</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,(</span><span class="n">ci_a</span><span class="p">,</span> <span class="n">ci_b</span><span class="p">),</span> <span class="n">ri</span><span class="p">,</span> <span class="n">newy</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,(</span><span class="n">ci_a</span><span class="p">,</span> <span class="n">ci_b</span><span class="p">),</span> <span class="n">ri</span><span class="p">)</span>
    
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
        <span class="c"># example data</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">15.3</span><span class="p">,</span> <span class="mf">10.8</span><span class="p">,</span> <span class="mf">8.1</span><span class="p">,</span> <span class="mf">19.5</span><span class="p">,</span> <span class="mf">7.2</span><span class="p">,</span> <span class="mf">5.3</span><span class="p">,</span> <span class="mf">9.3</span><span class="p">,</span> <span class="mf">11.1</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">,</span> <span class="mf">12.2</span><span class="p">,</span>
                      <span class="mf">6.7</span><span class="p">,</span> <span class="mf">5.2</span><span class="p">,</span> <span class="mf">19.0</span><span class="p">,</span> <span class="mf">15.1</span><span class="p">,</span> <span class="mf">6.7</span><span class="p">,</span> <span class="mf">8.6</span><span class="p">,</span> <span class="mf">4.2</span><span class="p">,</span> <span class="mf">10.3</span><span class="p">,</span> <span class="mf">12.5</span><span class="p">,</span> <span class="mf">16.1</span><span class="p">,</span> 
                      <span class="mf">13.3</span><span class="p">,</span> <span class="mf">4.9</span><span class="p">,</span> <span class="mf">8.8</span><span class="p">,</span> <span class="mf">9.5</span><span class="p">])</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.76</span><span class="p">,</span> <span class="mf">1.34</span><span class="p">,</span> <span class="mf">1.27</span><span class="p">,</span> <span class="mf">1.47</span><span class="p">,</span> <span class="mf">1.27</span><span class="p">,</span> <span class="mf">1.49</span><span class="p">,</span> <span class="mf">1.31</span><span class="p">,</span> <span class="mf">1.09</span><span class="p">,</span> <span class="mf">1.18</span><span class="p">,</span> 
                      <span class="mf">1.22</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span> <span class="mf">1.19</span><span class="p">,</span> <span class="mf">1.95</span><span class="p">,</span> <span class="mf">1.28</span><span class="p">,</span> <span class="mf">1.52</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">1.12</span><span class="p">,</span> <span class="mf">1.37</span><span class="p">,</span> 
                      <span class="mf">1.19</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">,</span> <span class="mf">1.32</span><span class="p">,</span> <span class="mf">1.03</span><span class="p">,</span> <span class="mf">1.12</span><span class="p">,</span> <span class="mf">1.70</span><span class="p">])</span>
                      
        <span class="n">goodIndex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">y</span><span class="p">)))</span>
        <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,(</span><span class="n">ci_a</span><span class="p">,</span> <span class="n">ci_b</span><span class="p">),</span> <span class="n">ri</span><span class="p">,</span><span class="n">newy</span><span class="p">)</span> <span class="o">=</span> <span class="n">fitLine</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">goodIndex</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="n">goodIndex</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span><span class="n">newx</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mf">4.5</span><span class="p">]))</span>        
</pre></div>
</div>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[4]</a></td><td>This section has been taken from Wikipedia</td></tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="StatsFH.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Correlation</a><ul>
<li><a class="reference internal" href="#correlation-coefficient">Correlation Coefficient</a></li>
<li><a class="reference internal" href="#rank-correlation">Rank correlation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#regression">Regression</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#assumptions">Assumptions</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="statsCategorical.html"
                        title="previous chapter">One Proportion</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="statsANOVA.html"
                        title="next chapter">Variance Analysis</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/statsRelation.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="statsANOVA.html" title="Variance Analysis"
             >next</a> |</li>
        <li class="right" >
          <a href="statsCategorical.html" title="One Proportion"
             >previous</a> |</li>
        <li><a href="StatsFH.html">Introduction to Statistics 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright March 2013, Thomas Haslwanter.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>